<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>M·ªôt ng√†y kh√≥ qu√™n</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-S..." crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Inter", sans-serif;
    }

    html, body {
      height: 100dvh;
      width: 100dvw;
      overflow: hidden;
    }

    body {
      display: grid;
      place-items: center;
      background: radial-gradient(circle at top, #3b0f42 0%, #120014 60%, #050007 100%);
      color: white;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    body::before,
    body::after {
      content: "";
      position: absolute;
      width: 500px;
      height: 500px;
      filter: blur(120px);
      pointer-events: none;
    }
    body::before { top: -150px; left: -120px; background: rgba(255,100,200,0.18); }
    body::after { bottom: -200px; right: -200px; background: rgba(140,80,255,0.18); }

    .screen {
      width: min(90vw, 360px);
      max-height: 95dvh;
      overflow-y: auto;
      padding: clamp(20px, 5vw, 32px) clamp(16px, 4vw, 28px);
      border-radius: 24px;
      background: rgba(35,10,45,0.78);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      text-align: center;
      position: relative;
    }

    .title {
      font-size: clamp(20px, 5vw, 24px);
      font-weight: 700;
      color: #ffd1e8;
      margin-bottom: 20px;
      font-family: cursive;
      letter-spacing: 0.3px;
    }

    .step { display: none; }
    .step.active { display: block; }

    .dots {
      display: flex;
      justify-content: center;
      gap: 14px;
      margin-bottom: 24px;
    }
    .dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 2.5px solid rgba(255,255,255,0.55);
      transition: all 0.25s ease;
    }
    .dot.filled {
      background: white;
      border-color: white;
      box-shadow: 0 0 12px rgba(255,255,255,0.7);
    }

    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin: 12px 0 20px;
    }
    .btn {
      aspect-ratio: 1;
      border-radius: 20px;
      border: none;
      font-size: clamp(20px, 6vw, 24px);
      font-weight: 600;
      background: rgba(255,255,255,0.09);
      color: white;
      display: grid;
      place-items: center;
      cursor: pointer;
      transition: all 0.18s ease;
      user-select: none;
    }
    .btn:hover { background: rgba(255,255,255,0.18); transform: scale(1.06); }
    .btn:active { transform: scale(0.94); background: rgba(255,255,255,0.25); }
    .btn.empty { background: transparent; cursor: default; pointer-events: none; }
    .btn.delete { font-size: clamp(22px, 6.5vw, 26px); }

    .message {
      min-height: 24px;
      font-size: clamp(13px, 3.5vw, 15px);
      font-weight: 500;
      opacity: 0.92;
      margin: 16px 0;
    }

    .shake { animation: shake 0.4s cubic-bezier(0.36,0.07,0.19,0.97) both; }
    @keyframes shake {
      10%, 90% { transform: translateX(-6px); }
      20%, 80% { transform: translateX(6px); }
      30%, 50%, 70% { transform: translateX(-4px); }
      40%, 60% { transform: translateX(4px); }
    }

    .loading {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-left: 10px;
      vertical-align: middle;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .footer {
      font-size: clamp(11px, 3vw, 13px);
      opacity: 0.6;
      margin-top: 16px;
    }

    /* Quiz styles */
    .quiz-box { text-align: left; margin-top: 12px; }
    .question {
      font-size: clamp(14px, 4vw, 16px);
      font-weight: 600;
      margin-bottom: 16px;
      line-height: 1.4;
    }
    .answers { display: flex; flex-direction: column; gap: 14px; }
    .answer-btn {
      width: 100%;
      padding: clamp(14px, 4vw, 18px) 18px;
      border-radius: 18px;
      border: 1.5px solid rgba(255,255,255,0.22);
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: clamp(15px, 4.2vw, 17px);
      text-align: left;
      cursor: pointer;
      transition: all 0.2s ease;
      line-height: 1.4;
    }
    .answer-btn:hover { background: rgba(255,255,255,0.18); }
    .answer-btn:active { transform: scale(0.98); }
    .answer-btn.correct { background: rgba(124,255,179,0.28); border-color: #7CFFB3; }
    .answer-btn.wrong { background: rgba(255,107,107,0.28); border-color: #ff6b6b; }

    .next-btn {
      margin-top: 20px;
      width: 100%;
      height: clamp(48px, 12vw, 56px);
      border: none;
      border-radius: 18px;
      background: rgba(255,182,217,0.25);
      color: #ffb6d9;
      font-weight: 700;
      font-size: clamp(15px, 4vw, 16px);
      cursor: pointer;
      transition: all 0.2s;
      display: none;
    }
    .next-btn:hover { background: rgba(255,182,217,0.4); transform: scale(1.03); }

    /* N√∫t nh·∫°c nh·ªè ·ªü g√≥c d∆∞·ªõi */
    #musicBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 100;
      background: rgba(255,182,217,0.3);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      color: #ffb6d9;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      transition: all 0.3s;
    }
    #musicBtn:hover {
      background: rgba(255,182,217,0.5);
      transform: scale(1.1);
    }
  </style>
</head>
<body>

  <div class="screen" id="screen">
    <!-- PASSWORD STEP -->
    <div class="step active" id="stepPassword">
      <div class="title">M·ªôt ng√†y kh√≥ qu√™n</div>
      <div class="dots" id="dots">
        <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
      </div>
      <div class="keypad" id="keypad">
        <button class="btn" data-num="1">1</button>
        <button class="btn" data-num="2">2</button>
        <button class="btn" data-num="3">3</button>
        <button class="btn" data-num="4">4</button>
        <button class="btn" data-num="5">5</button>
        <button class="btn" data-num="6">6</button>
        <button class="btn" data-num="7">7</button>
        <button class="btn" data-num="8">8</button>
        <button class="btn" data-num="9">9</button>
        <button class="btn empty"></button>
        <button class="btn" data-num="0">0</button>
        <button class="btn delete" id="delBtn"><i class="fa-solid fa-delete-left"></i></button>
      </div>
      <div class="message" id="msg"></div>
      <div class="footer">G·ª£i √Ω: Ng√†y k·ª∑ ni·ªám c·ªßa ch√∫ng ta</div>
    </div>

    <!-- QUIZ STEP -->
    <div class="step" id="stepQuiz">
      <div class="title">Quizizz Love</div>
      <div class="quiz-box">
        <div class="question" id="qText"></div>
        <div class="answers" id="answers"></div>
        <button class="next-btn" id="nextBtn">Ti·∫øp nh√≥ ‚ûú</button>
        <div class="message" id="quizMsg"></div>
      </div>
      <div class="footer">Kh√¥ng ƒë√∫ng kh√¥ng cho qua nha b√© üíï</div>
    </div>

    <!-- FINISH STEP -->
    <div class="step" id="stepFinish">
      <div class="title">Gi·ªèi l·∫Øm b√¢y bi</div>
      <div class="message" style="color:#7CFFB3; font-size: clamp(14px,4vw,16px);">
        C√≥ b·∫•t ng·ªù ƒëang ƒë·∫øn cho b√© ... <span class="loading"></span>
      </div>
      <div class="footer">Ch·ªù anh m·ªôt t·∫πo nh√≥ üòç</div>
    </div>
  </div>

  <!-- Nh·∫°c n·ªÅn (thay link nh·∫°c anh th√≠ch v√†o ƒë√¢y) -->
  <audio id="bgMusic" loop>
    <!-- Link nh·∫°c l√£ng m·∫°n nh·∫π nh√†ng, anh thay b·∫±ng link anh mu·ªën (mp3 t·ª´ Google Drive, Dropbox, ho·∫∑c host mi·ªÖn ph√≠) -->
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    <!-- V√≠ d·ª• link kh√°c: https://cdn.pixabay.com/download/audio/2022/03/15/audio_...mp3 -->
  </audio>

  <!-- N√∫t Play/Pause nh·∫°c (g√≥c d∆∞·ªõi ph·∫£i) -->
  <button id="musicBtn" title="Ph√°t/D·ª´ng nh·∫°c"><i class="fas fa-music"></i></button>

  <script>
    // Config
    const PASS = "1806";
    const REDIRECT = "https://panbap.github.io/HeartBeat/lovequiz.html?id=eyJsIjoiIiwibSI6IiIsIm4iOiJCw6J5IGJpIMahaSBhbmggY8OzIMSRaeG7gXUgbXXhu5FuIG7Ds2kuLi4uIiwibyI6IkFuaCB0aMawxqFuZyBiw6kgbmhp4buBdSBs4bqvbSAiLCJnIjoiROG6oSBiw6kgbmdoZSEiLCJoIjoiTmdoZSBz4bq9IGPDsyBxdcOgIG5ow7MhIn0%3D";
    const quiz = [
      { q: "1) Tin nh·∫Øn ƒë·∫ßu ti√™n c·ªßa ch√∫ng m√¨nh l√† g√¨?", a: ["Helu B√®o","Hellu B√®o","D√¥ nghi·ªán","Helu Ti√™uüòí"], c:0 },
      { q: "2) SetLove l√† ng√†y n√†o?", a: ["18/10","19/08","18/09","B√© hong nh·ªõ"], c:2 },
      { q: "3) FirstDate m√¨nh ƒë√£ ƒëi ƒë√¢u l√†m g√¨?", a: ["ƒêi c√† ph∆°","ƒêi t√¥ t∆∞·ª£ng","Hun nhau","D·∫° t·∫•t c·∫£ ƒë·ªÅu ƒë√∫ng ·∫°"], c:3 },
      { q: "4) Em th·∫•y m√¨nh l√† ng∆∞·ªùi nh∆∞ th·∫ø n√†o?", a: ["Qu√° xinh","Qu√° t√¢m l√Ω","Y√™u D∆∞∆°ng Minh nh·∫•t","B√© l·∫•y h·∫øt"], c:3 }
    ];

    // Elements
    const el = {
      screen: document.getElementById("screen"),
      msg: document.getElementById("msg"),
      quizMsg: document.getElementById("quizMsg"),
      dots: document.querySelectorAll("#dots .dot"),
      keypad: document.getElementById("keypad"),
      delBtn: document.getElementById("delBtn"),
      nextBtn: document.getElementById("nextBtn"),
      answers: document.getElementById("answers"),
      qText: document.getElementById("qText")
    };

    let pin = "";
    let qIndex = 0;
    let answered = false;

    const updateDots = () => el.dots.forEach((d,i) => d.classList.toggle("filled", i < pin.length));

    const addNum = num => {
      if (pin.length >= 4) return;
      pin += num;
      updateDots();
      if (pin.length === 4) checkPin();
    };

    const removeLast = () => {
      pin = pin.slice(0,-1);
      updateDots();
      el.msg.textContent = "";
    };

    const checkPin = () => {
      if (pin === PASS) {
        el.msg.style.color = "#7CFFB3";
        el.msg.innerHTML = "G√∫t chop ... <span class='loading'></span>";
        // B·∫Øt ƒë·∫ßu ph√°t nh·∫°c khi ƒë√∫ng m·∫≠t kh·∫©u
        document.getElementById("bgMusic").play().catch(() => console.log("T·ª± ƒë·ªông play b·ªã ch·∫∑n, nh·∫•n Play Music nh√©"));
        setTimeout(() => { show("stepQuiz"); startQuiz(); }, 900);
      } else {
        el.msg.style.color = "#ff6b6b";
        el.msg.textContent = "Sai g√≤iüò≠";
        el.screen.classList.add("shake");
        setTimeout(() => {
          el.screen.classList.remove("shake");
          pin = "";
          updateDots();
          el.msg.textContent = "";
        }, 900);
      }
    };

    const show = id => {
      document.querySelectorAll(".step").forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    };

    const startQuiz = () => { qIndex = 0; loadQ(); };

    const loadQ = () => {
      answered = false;
      el.quizMsg.textContent = "";
      el.nextBtn.style.display = "none";
      const curr = quiz[qIndex];
      el.qText.textContent = curr.q;
      el.answers.innerHTML = "";
      curr.a.forEach((txt, i) => {
        const b = document.createElement("button");
        b.className = "answer-btn";
        b.textContent = txt;
        b.addEventListener("click", () => pick(i, b));
        el.answers.appendChild(b);
      });
    };

    const pick = (idx, btn) => {
      if (answered) return;
      const curr = quiz[qIndex];
      const all = el.answers.querySelectorAll(".answer-btn");

      if (idx === curr.c) {
        answered = true;
        btn.classList.add("correct");
        el.quizMsg.style.color = "#7CFFB3";
        el.quizMsg.textContent = "Hay qu√° ta";
        all.forEach(b => b.disabled = true);
        el.nextBtn.style.display = "block";
      } else {
        btn.classList.add("wrong");
        el.quizMsg.style.color = "#ff6b6b";
        el.quizMsg.textContent = "Shao b√© l·∫°i shineüò≠!";
        setTimeout(() => {
          btn.classList.remove("wrong");
          el.quizMsg.textContent = "";
        }, 600);
      }
    };

    const nextQ = () => {
      qIndex++;
      if (qIndex >= quiz.length) {
        show("stepFinish");
        setTimeout(() => {
          // D·ª´ng nh·∫°c tr∆∞·ªõc khi redirect (n·∫øu mu·ªën)
          document.getElementById("bgMusic").pause();
          location.href = REDIRECT;
        }, 1800);
      } else loadQ();
    };

    // Events
    el.keypad.addEventListener("click", e => {
      const b = e.target.closest(".btn");
      if (!b || b.classList.contains("empty")) return;
      if (b.dataset.num) addNum(b.dataset.num);
    });

    el.delBtn.addEventListener("click", removeLast);
    el.nextBtn.addEventListener("click", nextQ);

    document.addEventListener("keydown", e => {
      if (!document.getElementById("stepPassword").classList.contains("active")) return;
      if (e.key >= "0" && e.key <= "9") addNum(e.key);
      if (e.key === "Backspace") removeLast();
    });

    // N√∫t Play/Pause nh·∫°c
    const musicBtn = document.createElement("button");
    musicBtn.id = "musicBtn";
    musicBtn.innerHTML = '<i class="fas fa-play"></i>';
    musicBtn.onclick = () => {
      const audio = document.getElementById("bgMusic");
      if (audio.paused) {
        audio.play();
        musicBtn.innerHTML = '<i class="fas fa-pause"></i>';
      } else {
        audio.pause();
        musicBtn.innerHTML = '<i class="fas fa-play"></i>';
      }
    };
    document.body.appendChild(musicBtn);
  </script>
</body>
</html>
